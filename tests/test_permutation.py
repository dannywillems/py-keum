import pytest
from keum.permutation import Poseidon
from keum.bn254 import Fr


# Parameters and expected results generated via: https://extgit.iaik.tugraz.at/krypto/hadeshash/-/tree/master
def test_poseidon_bn254_params():
    Poseidon.MATRIX = [
        [
            Fr(0x09600146BEC7F4FD625EA9DB1F247C6376F479F8FA4B34F1227F14AC41BC4CD3),
            Fr(0x1EB832B908B873BE41B430E81E9F5FA648080F6A139F5A64570E848CB09C9292),
            Fr(0x00868C3677AAEB8A5B01FC0C44F5D2367A26DB160AE28EB98B63CCCBEA20D8AF),
        ],
        [
            Fr(0x0B9A382DB8289F520ECE763CBB2094C444663A2BF55DB56999A4614A96504EBE),
            Fr(0x2DE7772476F303A6D2879CDCC47C1113EF4E1936FB876D034BBCDA5ACDC435EC),
            Fr(0x27948D4BCB6D665205572EBBDE236B7624DA6487F1B18FDBBC44E7A2DD3D793D),
        ],
        [
            Fr(0x1FCEFC218B5675FEED028865D2F9EF22A1E31F41F7CE7631F645471265344DC4),
            Fr(0x0D7B02B0F922E679DFD828024C17296596770FDC936F9B16AE612716CE444B3B),
            Fr(0x1EE23B55636874A2CA16A9F3C1F9BC4FF17410F229A1271D46FDC664EE4511C7),
        ],
    ]

    Poseidon.ROUND_CONSTANTS = [
        Fr(0x1D066A255517B7FD8BDDD3A93F7804EF7F8FCDE48BB4C37A59A09A1A97052816),
        Fr(0x29DAEFB55F6F2DC6AC3F089CEBCC6120B7C6FEF31367B68EB7238547D32C1610),
        Fr(0x1F2CB1624A78EE001ECBD88AD959D7012572D76F08EC5C4F9E8B7AD7B0B4E1D1),
        Fr(0x0AAD2E79F15735F2BD77C0ED3D14AA27B11F092A53BBC6E1DB0672DED84F31E5),
        Fr(0x2252624F8617738CD6F661DD4094375F37028A98F1DECE66091CCF1595B43F28),
        Fr(0x1A24913A928B38485A65A84A291DA1FF91C20626524B2B87D49F4F2C9018D735),
        Fr(0x22FC468F1759B74D7BFC427B5F11EBB10A41515DDFF497B14FD6DAE1508FC47A),
        Fr(0x1059CA787F1F89ED9CD026E9C9CA107AE61956FF0B4121D5EFD65515617F6E4D),
        Fr(0x02BE9473358461D8F61F3536D877DE982123011F0BF6F155A45CBBFAE8B981CE),
        Fr(0x0EC96C8E32962D462778A749C82ED623ABA9B669AC5B8736A1FF3A441A5084A4),
        Fr(0x292F906E073677405442D9553C45FA3F5A47A7CDB8C99F9648FB2E4D814DF57E),
        Fr(0x274982444157B86726C11B9A0F5E39A5CC611160A394EA460C63F0B2FFE5657E),
        Fr(0x1A1D063E54B1E764B63E1855BFF015B8CEDD192F47308731499573F23597D4B5),
        Fr(0x26ABC66F3FDF8E68839D10956259063708235DCCC1AA3793B91B002C5B257C37),
        Fr(0x0C7C64A9D887385381A578CFED5AED370754427AABCA92A70B3C2B12FF4D7BE8),
        Fr(0x1CF5998769E9FAB79E17F0B6D08B2D1EBA2EBAC30DC386B0EDD383831354B495),
        Fr(0x0F5E3A8566BE31B7564CA60461E9E08B19828764A9669BC17ABA0B97E66B0109),
        Fr(0x18DF6A9D19EA90D895E60E4DB0794A01F359A53A180B7D4B42BF3D7A531C976E),
        Fr(0x04F7BF2C5C0538AC6E4B782C3C6E601AD0EA1D3A3B9D25EF4E324055FA3123DC),
        Fr(0x29C76CE22255206E3C40058523748531E770C0584AA2328CE55D54628B89EBE6),
        Fr(0x198D425A45B78E85C053659AB4347F5D65B1B8E9C6108DBE00E0E945DBC5FF15),
        Fr(0x25EE27AB6296CD5E6AF3CC79C598A1DAA7FF7F6878B3C49D49D3A9A90C3FDF74),
        Fr(0x138EA8E0AF41A1E024561001C0B6EB1505845D7D0C55B1B2C0F88687A96D1381),
        Fr(0x306197FB3FAB671EF6E7C2CBA2EEFD0E42851B5B9811F2CA4013370A01D95687),
        Fr(0x1A0C7D52DC32A4432B66F0B4894D4F1A21DB7565E5B4250486419EAF00E8F620),
        Fr(0x2B46B418DE80915F3FF86A8E5C8BDFCCEBFBE5F55163CD6CAA52997DA2C54A9F),
        Fr(0x12D3E0DC0085873701F8B777B9673AF9613A1AF5DB48E05BFB46E312B5829F64),
        Fr(0x263390CF74DC3A8870F5002ED21D089FFB2BF768230F648DBA338A5CB19B3A1F),
        Fr(0x0A14F33A5FE668A60AC884B4CA607AD0F8ABB5AF40F96F1D7D543DB52B003DCD),
        Fr(0x28EAD9C586513EAB1A5E86509D68B2DA27BE3A4F01171A1DD847DF829BC683B9),
        Fr(0x1C6AB1C328C3C6430972031F1BDB2AC9888F0EA1ABE71CFFEA16CDA6E1A7416C),
        Fr(0x1FC7E71BC0B819792B2500239F7F8DE04F6DECD608CB98A932346015C5B42C94),
        Fr(0x03E107EB3A42B2ECE380E0D860298F17C0C1E197C952650EE6DD85B93A0DDAA8),
        Fr(0x2D354A251F381A4669C0D52BF88B772C46452CA57C08697F454505F6941D78CD),
        Fr(0x094AF88AB05D94BAF687EF14BC566D1C522551D61606EDA3D14B4606826F794B),
        Fr(0x19705B783BF3D2DC19BCAEABF02F8CA5E1AB5B6F2E3195A9D52B2D249D1396F7),
        Fr(0x09BF4ACC3A8BCE3F1FCC33FEE54FC5B28723B16B7D740A3E60CEF6852271200E),
        Fr(0x1803F8200DB6013C50F83C0C8FAB62843413732F301F7058543A073F3F3B5E4E),
        Fr(0x0F80AFB5046244DE30595B160B8D1F38BF6FB02D4454C0ADD41F7FEF2FAF3E5C),
        Fr(0x126EE1F8504F15C3D77F0088C1CFC964ABCFCF643F4A6FEA7DC3F98219529D78),
        Fr(0x23C203D10CFCC60F69BFB3D919552CA10FFB4EE63175DDF8EF86F991D7D0A591),
        Fr(0x2A2AE15D8B143709EC0D09705FA3A6303DEC1EE4EEC2CF747C5A339F7744FB94),
        Fr(0x07B60DEE586ED6EF47E5C381AB6343ECC3D3B3006CB461BBB6B5D89081970B2B),
        Fr(0x27316B559BE3EDFD885D95C494C1AE3D8A98A320BAA7D152132CFE583C9311BD),
        Fr(0x1D5C49BA157C32B8D8937CB2D3F84311EF834CC2A743ED662F5F9AF0C0342E76),
        Fr(0x2F8B124E78163B2F332774E0B850B5EC09C01BF6979938F67C24BD5940968488),
        Fr(0x1E6843A5457416B6DC5B7AA09A9CE21B1D4CBA6554E51D84665F75260113B3D5),
        Fr(0x11CDF00A35F650C55FCA25C9929C8AD9A68DAF9AC6A189AB1F5BC79F21641D4B),
        Fr(0x21632DE3D3BBC5E42EF36E588158D6D4608B2815C77355B7E82B5B9B7EB560BC),
        Fr(0x0DE625758452EFBD97B27025FBD245E0255AE48EF2A329E449D7B5C51C18498A),
        Fr(0x2AD253C053E75213E2FEBFD4D976CC01DD9E1E1C6F0FB6B09B09546BA0838098),
        Fr(0x1D6B169ED63872DC6EC7681EC39B3BE93DD49CDD13C813B7D35702E38D60B077),
        Fr(0x1660B740A143664BB9127C4941B67FED0BE3EA70A24D5568C3A54E706CFEF7FE),
        Fr(0x0065A92D1DE81F34114F4CA2DEEF76E0CEACDDDB12CF879096A29F10376CCBFE),
        Fr(0x1F11F065202535987367F823DA7D672C353EBE2CCBC4869BCF30D50A5871040D),
        Fr(0x26596F5C5DD5A5D1B437CE7B14A2C3DD3BD1D1A39B6759BA110852D17DF0693E),
        Fr(0x16F49BC727E45A2F7BF3056EFCF8B6D38539C4163A5F1E706743DB15AF91860F),
        Fr(0x1ABE1DEB45B3E3119954175EFB331BF4568FEAF7EA8B3DC5E1A4E7438DD39E5F),
        Fr(0x0E426CCAB66984D1D8993A74CA548B779F5DB92AAEC5F102020D34AEA15FBA59),
        Fr(0x0E7C30C2E2E8957F4933BD1942053F1F0071684B902D534FA841924303F6A6C6),
        Fr(0x0812A017CA92CF0A1622708FC7EDFF1D6166DED6E3528EAD4C76E1F31D3FC69D),
        Fr(0x21A5ADE3DF2BC1B5BBA949D1DB96040068AFE5026EDD7A9C2E276B47CF010D54),
        Fr(0x01F3035463816C84AD711BF1A058C6C6BD101945F50E5AFE72B1A5233F8749CE),
        Fr(0x0B115572F038C0E2028C2AAFC2D06A5E8BF2F9398DBD0FDF4DCAA82B0F0C1C8B),
        Fr(0x1C38EC0B99B62FD4F0EF255543F50D2E27FC24DB42BC910A3460613B6EF59E2F),
        Fr(0x1C89C6D9666272E8425C3FF1F4AC737B2F5D314606A297D4B1D0B254D880C53E),
        Fr(0x03326E643580356BF6D44008AE4C042A21AD4880097A5EB38B71E2311BB88F8F),
        Fr(0x268076B0054FB73F67CEE9EA0E51E3AD50F27A6434B5DCEB5BDDE2299910A4C9),
        Fr(0x1ACD63C67FBC9AB1626ED93491BDA32E5DA18EA9D8E4F10178D04AA6F8747AD0),
        Fr(0x19F8A5D670E8AB66C4E3144BE58EF6901BF93375E2323EC3CA8C86CD2A28B5A5),
        Fr(0x1C0DC443519AD7A86EFA40D2DF10A011068193EA51F6C92AE1CFBB5F7B9B6893),
        Fr(0x14B39E7AA4068DBE50FE7190E421DC19FBEAB33CB4F6A2C4180E4C3224987D3D),
        Fr(0x1D449B71BD826EC58F28C63EA6C561B7B820FC519F01F021AFB1E35E28B0795E),
        Fr(0x1EA2C9A89BAADDBB60FA97FE60FE9D8E89DE141689D1252276524DC0A9E987FC),
        Fr(0x0478D66D43535A8CB57E9C1C3D6A2BD7591F9A46A0E9C058134D5CEFDB3C7FF1),
        Fr(0x19272DB71EECE6A6F608F3B2717F9CD2662E26AD86C400B21CDE5E4A7B00BEBE),
        Fr(0x14226537335CAB33C749C746F09208ABB2DD1BD66A87EF75039BE846AF134166),
        Fr(0x01FD6AF15956294F9DFE38C0D976A088B21C21E4A1C2E823F912F44961F9A9CE),
        Fr(0x18E5ABEDD626EC307BCA190B8B2CAB1AAEE2E62ED229BA5A5AD8518D4E5F2A57),
        Fr(0x0FC1BBCEBA0590F5ABBDFFA6D3B35E3297C021A3A409926D0E2D54DC1C84FDA6),
        Fr(0x30347F53E91A637FCA1D8A1E828D6FB969E737481AD3376D722513091C0F90C9),
        Fr(0x0DE59A358F0ECD2D5BBB3625C3B071A42B475BCA9222507C955254E81E2F98B7),
        Fr(0x192367E65F923E2F6ADE0FAD0239743874B77A8DE8088D62CC96F373156ECF16),
        Fr(0x01A992B6AF0424B93F830A979873E59685C66AFFC3A6B6CA87FB421D18DC887D),
        Fr(0x1E9BDF5427A5620701BB81C2F854AD8EE69FF2B4A8069C8869ACD5BD3EF74EC8),
        Fr(0x1B256E0FB7D5EC339DAA27F20A017A07BA8D4ADAF1D05142547F82D6082F7A42),
        Fr(0x2A5BC4AD257499EA42A53A531910F9A32B4DB734215D1B8D28256D1B1EF38E70),
        Fr(0x27FCEC3B431BEFCB471C4DF705B59AC018F4BB1C58E49C51008F29A51B837F90),
        Fr(0x22961D12DC1F96BCE1B57AFCE557EF947E1B8F20E81273EB5533EF8556278A6C),
        Fr(0x011C5653AC8B64CD159DC124B2DD142FCAEAA2086307C785824D8597F7A1EE1D),
        Fr(0x1D519FEAE9827D0B1BB7F14A272F5535A35856FDFBFF1BF85A059C31D45681DF),
        Fr(0x2EE9619ACD36E9EC3617767F07407F43D48BA40840A736180BFB2ACE24F85C7C),
        Fr(0x2637F99FCE7463A906EFAADC0C12122E98C670F6363A7E83BF49E225930593DB),
        Fr(0x1C12745737824622FD8F15456B011E1D0B9E4526C415AC38892C7BC6DE6C5FA8),
        Fr(0x19B98D3FC8E2B487C78FBB1EB365C232CF46A209C7C563163947C8BE4D4EE971),
        Fr(0x04BF0EE44E25B5B08C9E5FC181190A5C2548EDBBEA40951A05E12BF8D3E3FECF),
        Fr(0x1508862A72542035F7DA6FEBB71116E47EFC62D62E31404ED3A789216B7F6718),
        Fr(0x29684CEDE059B92E0D17CD476ADC475CA6C001641752CCD3C93483C58E651560),
        Fr(0x11FBA1DE926DC812F9DE635C42F2F4817A5D7203CEDF2E1E5B13525D22FAE357),
        Fr(0x1C79B44BA583F341AA2CAB67A1E377F0B62DC3229BD5951BAE6E048D1407695C),
        Fr(0x0EFAC6637312C7025F8981E3BEF465F49D4ED20E9A725159F0E265272D406547),
        Fr(0x0202E9ABDE9C96289BDAE42661A2494D0414B3CA42D99011A4C31EC29A65ED71),
        Fr(0x182965CFA2BD901525BA84AD7540B380EB65D92099C4F2E6BDAB55F7BD7A6E36),
        Fr(0x2B228D8943F9F31B13DE90198396845ED50CD22E08BB9C7078D84810E5B3FCBC),
        Fr(0x00D577D378751869BDAF4F7A66DE23217134DCC67AF29CCEA82BF5B7F8B53189),
        Fr(0x243B0FA88AEDC975CBE2E286DCDC284CAC4AB168A524ECC14B1216CF007135B6),
        Fr(0x27C7CA4BF4290D1E6B693322655AFE507DBED93EFBF39852BB64B331E0E8F39F),
        Fr(0x27D0AB1D52D5DAFA31652793025C0B3BC9B1B6D3330A13E05A8432364A9F2B9B),
        Fr(0x14AE1C11DE5120E670CF9BE3444611983B71E8CDC6B20A2C667632A10A6237BF),
        Fr(0x23D1B30E1E91DC0275A0ABAAB437389623804C387D91E98054AB0FEE62B03E8B),
        Fr(0x2D3071B44B0819A33728C4C945200C5D07B4046697F44A6A9EAA36EC4A768011),
        Fr(0x1C91211710526C8D43588E11DCE44E8D19ABE4E74255D170E9C17584F0578BDB),
        Fr(0x124D84D94425E4DCC9494762BD423BF08C970C63E9DE1A173FE7E877658E3154),
        Fr(0x0A0487E7FE653FF630F59AF8443B4F79632E918208BC645FE96E0364711669B8),
        Fr(0x10A8C9FA3AE6B3F010202D63A195E5A1CE6DF40B60A158FACA9488330A037BB8),
        Fr(0x168DC103F522A4558D97B24A71990ED38203879551CCC4BF3DC57D6043D7821C),
        Fr(0x22417EA97FA7AB926F6B4D36D00A86B03E0F7BE7D6D8E2A1955E954C18B33A8B),
        Fr(0x2A6174D4B9FA90538E4539A1BC5D2C88AABFAE97EF1E66644D4C4588DDD62C84),
        Fr(0x1CC248057EB0FD28F1F753F5F85FE03BA0EC8F3053B06F4FEB4A3DBD496DEF2F),
        Fr(0x14DBCC08B921C358DB26D85746562D0B51917D56EB9E6779664E502BEA28462E),
        Fr(0x1D28A4F9CD6146551EBDF33AFCB5BABFEBD3EB9DA7857FB0ADDB965BF3E3A372),
        Fr(0x1596900CE091CEA8799615F5F52961461DF7F00FCA9D73B55574A8085D74B5B3),
        Fr(0x0978D75A71E9CCCCC2FF0DBCA6A34784E5CA3101C2EA84E1EA7684BBB6E18837),
        Fr(0x1B1F1CB131CB037D14D158726CE96B73E7FA17C075872E056644E73D8D925DD7),
        Fr(0x156EECC345D11B0073E482762012502EE508AF74557FB1DAAC95B01934938E62),
        Fr(0x224421A4D0A2FE503CD90416EB80593E6DEF8D1F1640804B15DF556815548D02),
        Fr(0x0A17879CF1B30BEA8C75376232DFA6666A9A106533A677204FE5832CB47E437D),
        Fr(0x25DA75173EBCBD286269ED32EFBC55EE6DB9BB4EBE637705F605C498E663C817),
        Fr(0x0AA00A02A18574063E1186EF3DEDB586BBBDC335DCBD30FD8E983B1642929927),
        Fr(0x300E19C48ED4866175F50ACDAA379C042C441C1CB34C4001D1FE9358F8B94AAD),
        Fr(0x2F22E43E2EC235DA7C99E04F7D34D725808E3653D322AC303A5EA1B0C4F6D630),
        Fr(0x03ADCD0ED6032A56B61F76A0122C0B67E7C7665EC79DA9EE005A50CCF490EA4C),
        Fr(0x235297C114D27B55CBDF5121CF44D611B3E9BE47A9C9768F5AB8807FCD2435A7),
        Fr(0x10F1182B447CFF3375F3375EFF839C2689168F09C65ED44114BE7287A2F8B4C8),
        Fr(0x1E6ADBF9397247807B6441703CE1A57E61C2AB95DE1E7FFBA10C4FCF49A57966),
        Fr(0x01A0C48C7936505B63833020C75EB00EA88939A33C810F761A4B045380135456),
        Fr(0x2DBC47B5021936F8C3577FBAA65B4FDA57BCEBD012AE5E7AA4E77703BE6D030E),
        Fr(0x1327666B84984CF65756D28092195E931185A3C928B09D46EB332B35EE5A468C),
        Fr(0x2BC934E3F91921EC3C28EDC8C725F79D7E169397ED56D8BE18AC39D308636CA9),
        Fr(0x183DD78940FBB6ECD564B267C43B5E5EB87802D66F897AEAF8F03221824A5CC0),
        Fr(0x2C3B99C113CAA8215CF5A9377346EFAC167C54563DD350FAC23688ACA7FA205B),
        Fr(0x0CFC218F63C5A59E9778251924FCBB0DF010313BEC2406B7E8EF87A9D82830CD),
        Fr(0x301A1BE9217E2CBFA3C9FBB8E1CDBA31759539B27C2F4D932B6E075992BC073D),
        Fr(0x0451168DB6416D9A2BD56D3B05303D395ECB8636F42C4E2CBCFC996F0A8B8D4F),
        Fr(0x0279FE381976EDA48032C8AE75F1ACA0662BEE641C5DF4A96E52DA33BD117458),
        Fr(0x2DD3F1DEA0C8D9F4793948270D814241747EF420A5F0D75829527D36C740E678),
        Fr(0x1BDE2068FD10CCC3EAEC0104A0008897FDF255AC8D6694D18D81DBB26682F28B),
        Fr(0x18E9925C649A6BF7C819DE04A1A15E1BDFF84104178E67C3BE59A3213B047613),
        Fr(0x0281FC392973D4972722A9B137A625C903716D7AAD74C22795D055CB4323BD14),
        Fr(0x0757134BE627B5FF9B3D7A20E7845F384FE26AE2E9C7D161DF4E63E8DB363415),
        Fr(0x1E96E7DA78032BE3B45DF5375E5AFF61DB332E1E5C0F67D778D8DEE4DB8CB576),
        Fr(0x10E29927E946E8145C6F4C615904CBDE50FD257D13C87C4BBD0B65B976DE377C),
        Fr(0x104F75276D0DA2364A0E03D4F115E83167BC3BC3340B86EAE7E98192104D6C60),
        Fr(0x01C6368CB969E2F8D255E95D5E962BA969624075CB6DFA5A04B0BD5ED1CD62DC),
        Fr(0x106FFFC94CA4ACBD764AF0E7F76856E1B30A6E067BEFAB8837A5A15CD32BE88F),
        Fr(0x15E78BF1F7C8BFE17DBD8A0155728C644FCBC3515AED35DD569B52010F0C95A2),
        Fr(0x000CAB14C0FF2CF1718FE666467055D18D8C192E3C02D598A38F5515985D16B8),
        Fr(0x23F34102470D94829F328E6141909B903F45D4DEEA6CE7FF017803BB1ABF9C75),
        Fr(0x1FD2D8CE7613D6B61D65F6EF7284F392E2CF207B0D323BA0EE0FC2AAA6935DA6),
        Fr(0x0C63086A8A20A108FA13FC8A57D078F0DF03695BAD70B3AC02CBDD24374FAD45),
        Fr(0x27CD3730E4714199FDB215A5C8D967F46B185FCC2F0E548EAAB631AAE5A2B54C),
        Fr(0x15ADAA75FC1F1595186C0D4D4A0164604CD1A1CF69F15FCA5EC79C1E524BE22B),
        Fr(0x05AA5E4FB84931226FE71314CDC4D64BD1E15619A346A9E8853183FB7AE19D02),
        Fr(0x27FB8CD694FCD1D058313959FCFC621A3CCB7A9A8EA245AC31C13FB6A57C4022),
        Fr(0x2BE0953FD8B1D2F6E463EE9A3F70E3E817565D61AF26C621713B207AD34EC7A7),
        Fr(0x217143E8AE458A9EF116CA2A15FC36CC469FCBE87B9C1AB6FCE03B25D20C25A2),
        Fr(0x29C3B69F65B5CFD2CFFD3123A0118D90F945E1EBA04FBCD916FA11B3D59328F2),
        Fr(0x2951CCD20B0A35B9603DE573D11918A98E99662B3311144EF81C16C84ED32FE9),
        Fr(0x202D7CF41DCBBB10B69B64F3E7D609617B9EE088DE1DB8B7AC4BCFBA87DBD048),
        Fr(0x014D390C7229D74A5B39DDDC6F0395EEC036A1E0D377CFCC9B1AD0686C3743B5),
        Fr(0x1479C1CFBD48817240820DC11E59D9BF16F7DFA3EBFCC3D4DD7E97292296262E),
        Fr(0x0684D98BB96761750F65D8933AB43397D4A96D8B6C61DED5816FCD74B562DFA0),
        Fr(0x1F4F4CD32539EDDCDA05A729297A2A5F892CD50179DF7CE1E4008373C89447A8),
        Fr(0x03326D7FDCD6CCC2371731B5752D957D1DFD792A5351C10BD958FFB04635B84F),
        Fr(0x1D5B99CB1E95E9D975BD7F99D1A95D7F0A5688D7E4965AAFBD76A271CB6E876D),
        Fr(0x13D909A621A86FCB4E9978DAE7F77A014174CC9F6FF6B8BA496F0513D2AF1054),
        Fr(0x16E7671D2D3A50C7CDBF3270E8BF1C4F18221F7BD7F899E313C45E28174D17CE),
        Fr(0x03AAC5E52AEDB6ACAD82466F062D38D8294C6AF6B5900C700C5323684153FDCD),
        Fr(0x086F0806C45CF713DC2C19A3332FABA6DF3A4C8C93E292C996D0886C81916D34),
        Fr(0x2A845E4CB08384E51A40A14687DA5AA91F9807D575B0D88A34E1F85A2E20E969),
        Fr(0x18D2A59257AFC8BD005F3B2804CBEEA1CAB18B6A62EFE2F4742D1E0ECCF06E8B),
        Fr(0x1A2D3094EC6931AC4D53E69338E5FB98610DEA28731816029B8AD15BE5361BE9),
        Fr(0x1CFE7A330A5001825299978E53F555DCD300210260C1D589AECA0DF6089CAD6D),
        Fr(0x0DA40FFF9F10C73AEA59002D40230B8933F2FDBC192553057E2784530825B921),
        Fr(0x0E05B77A1A396B75DBF6E8E234F30C846561DE1FAEC70EEFC0393DF01E079FF5),
        Fr(0x1A044B846A4BB239DCD58B95D6656A452151BEC40F3084B4325F918029BF262E),
        Fr(0x2E139AE51418B64F78043335DDCAB1B8C349540DB935E2BCA89493B0EA189784),
        Fr(0x0741808912CA9CBF94A0228663125866E4F28F77AF515B1170EE063A7F676240),
        Fr(0x0B29628EE57E1D55F70F9059BB80E3608642E046003218807F69B40D94E8CC91),
        Fr(0x060804C31FB3BE30DD5475CDCABCE8AFA21DDF46B4631583565F949933FBF9D1),
        Fr(0x2760F6B6590A73A863F9BD30D8CB6002D195FA252B0CD84F36D3955E853B3592),
        Fr(0x14AA7543A56C144A6FA53CB6D2E0537C2C65B571104DEF5A67D6F228492C2C5B),
    ]

    Poseidon.ALPHA = 5
    Poseidon.NB_FULL_ROUND = 8
    Poseidon.NB_PARTIAL_ROUND = 56
    Poseidon.STATE_SIZE = 3

    Poseidon.Field = Fr

    state = [
        Fr(0x0000000000000000000000000000000000000000000000000000000000000000),
        Fr(0x0000000000000000000000000000000000000000000000000000000000000001),
        Fr(0x0000000000000000000000000000000000000000000000000000000000000002),
    ]
    p = Poseidon(state)
    p.apply_permutation()

    expected = [
        Fr(0x1C1E457A6EF28389AA023B17AA23A8BD43ABDB381D28B59E62DBA7CDE8321155),
        Fr(0x01D23EABCF873CF73FB12B28CB99BC88F27E7FC4EF7076BD18462D4EFC907340),
        Fr(0x179E2B28B7CFFB8B989F97AA8391BAEC323ADAD97DE4E6F57BEE6A76408B5F87),
    ]
    assert p.state == expected
